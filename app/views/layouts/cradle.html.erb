<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" >
<html>
<head>
	<title>Cradle--ChaSen Dictionary Management System</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<%= stylesheet_link_tag "cradle", :media => "all" %>
	<%= javascript_include_tag :defaults %>
	
	<!-- For main menu... -->
	<%= stylesheet_link_tag "top_menu", :media => "all" %>

    <!-- For tree view -->
	<%= javascript_include_tag "ECOTree.js" %>
	<%= stylesheet_link_tag "ECOTree", :media => "all" %>
	
	<!-- For dumping progress bar -->
	<%= javascript_include_tag "jsProgressBarHandler.js" %>
</head>

<body id="ChaSen">
	<div>
		<div style="float:left; padding-top:10px;"><%= image_tag("matsu-logo.gif") %></div>
		
		<div id="banner" align="right">
			<div>
				<table style="width:95%;">
					<tr>
						<td style="width:5%;"></td>
						<td style="width:90%;"><%= @page_title || "Cradle--ChaSen Dictionary Management System" %></td>
						<td style="width:5%; text-align:right;">
							<%= image_tag("firefox.png", :style=>"vertical-align:bottom;") %>
							<%= image_tag("rails.png", :style=>"vertical-align:bottom;") %>
						</td>
					</tr>
				</table>
			</div>
		</div>
	</div>
	
	<div id="navigation">
		<% @user=User.find_by_id(session[:user_id])%>
	    <% if not @user.blank? %>
			<div class="top_menu">
				<ul>
					<li class="first_level_first"><a href="/jp">日本語辞書</a>
						<ul>
							<li><a href="/jp">Top</a></li>
							<li><a href="/jp/new">新規単語</a></li>
							<li><a href="/jp/define_root">Root編集</a></li>
							<% if @user.group_name == 'admin' %>
								<li><a href="/property/lexeme_property_index?domain=jp">属性管理</a>
									<ul>
										<li class="third_level_first"><a href="/property/lexeme_property_index?domain=jp">単語属性</a></li>
										<li><a href="/property/synthetic_property_index?domain=jp">複合語属性</a></li>
									</ul>
								</li>
							<% end %>	
						</ul>
					</li>
					<li class="first_level"><a href="/cn">中文辞典</a>
						<ul>
							<li><a href="/cn">Top</a></li>
							<li><a href="/cn/new">创建单词</a></li>
							<% if @user.group_name == 'admin' %>
								<li><a href="/property/lexeme_property_index?domain=cn">属性管理</a>
									<ul>
										<li class="third_level_first"><a href="/property/lexeme_property_index?domain=cn">单词属性</a></li>
										<li><a href="/property/synthetic_property_index?domain=cn">合成词属性</a></li>
									</ul>
								</li>
							<% end %>
						</ul>
					</li>
				</ul>
			</div>
			<div id="navigation-login" style="display:inline;">
				<%= @user.name %></td>
				 &nbsp | &nbsp
				<%= link_to 'Preferrence', :controller=>'/users', :action=>'chg_pwd' %>
				 &nbsp | &nbsp 
				<% if @user.group_name=="admin" %>
					<%= link_to 'User list', :controller=>'/users', :action=>'list_users' %>
					 &nbsp | &nbsp
				<% end %>
				<%= link_to 'Logout', :controller=>'/users', :action => 'logout' %>
			</div>
		<% else %>
			<div class="top_menu">
				<ul>
					<li class="first_level_first"><a href="/jp">日本語辞書</a></li>
					<li class="first_level"><a href="/cn">中文辞典</a></li>
				</ul>
			</div>
			<div id="navigation-login">
	        	<%= link_to 'Login', :controller=>'/users', :action => 'login' %>
			</div>
		<% end %>
	</div>
	<div id="main">
		<% if not flash.now[:notice].blank? %>
			<div id="notice"><%= flash.now[:notice] %></div>
		<% elsif not flash.now[:notice_err].blank? %>
			<div id="notice_err" ><%= flash.now[:notice_err] %></div>
		<% elsif not flash[:notice].blank? %>
			<div id="notice" ><%= flash[:notice] %></div>
		<% elsif not flash[:notice_err].blank? %>
			<div id="notice_err" ><%= flash[:notice_err] %></div>
        <% end %>
		<%= yield :layout %>
	</div>
</body>
</html>